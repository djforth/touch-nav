{"version":3,"sources":["src/stores/nav_store.js"],"names":["EventEmitter","require","_","NavDispatcher","nav_items","store","emitChange","event","emit","addChangeListener","callback","on","removeChangeListener","removeListener","addNavItems","items","id","uniqueId","push","setItems","changeActive","nav_id","getNavItems","map","item","active","ni","find","first","setNavItems","has","NavStore","Object","assign","prototype","registeredCallback","payload","action","type","nav","dispatchToken","register","setMaxListeners","module","exports"],"mappings":"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","file":"nav_store.js","sourceRoot":"/Users/adrianstainforth/sites/modules/touch-nav","sourcesContent":["const EventEmitter  = require(\"events\").EventEmitter;\n\nconst _ = require(\"lodash/core\");\n\nconst NavDispatcher = require(\"../dispatchers/nav_dispatcher\");\n\n\nlet nav_items = [];\n\nconst store = {\n  emitChange(event) {\n    this.emit(event);\n  },\n\n  addChangeListener(event, callback) {\n    this.on(event, callback);\n  },\n\n  removeChangeListener(event, callback) {\n    this.removeListener(event, callback);\n  },\n\n  addNavItems(items, id){\n    id = (id) ? id : _.uniqueId(\"nav\");\n\n    nav_items.push({items:this.setItems(items), id:id});\n  },\n\n  changeActive(id, nav_id){\n    let items = this.getNavItems(nav_id);\n    items = _.map(items, (item)=>{\n      item.active = (item.id === id);\n      return item;\n    });\n  },\n\n  getNavItems(id){\n    if(id){\n      let ni = _.find(nav_items, (ni)=>ni.id === id)\n      if(ni) return ni.items\n    }\n\n    return _.first(nav_items).items\n  },\n\n  setNavItems(id, items){\n    nav_items = _.map(nav_items, (ni)=>{\n      if(ni.id === id){\n        ni.items = items;\n      }\n      return ni;\n    })\n  },\n\n  setItems(items){\n    return _.map(items, (item)=>{\n      if(!_.has(item, \"active\")) item.active = false;\n      if(!_.has(item, \"id\")) item.id = _.uniqueId();\n      return item;\n    })\n  }\n}\n\n\nconst NavStore = Object.assign({}, EventEmitter.prototype, store);\n\nconst registeredCallback = function(payload) {\n  let action = payload.action;\n  switch(action.type) {\n    case \"ADDING_NAV\":\n      NavStore.addNavItems(action.nav, action.id);\n      NavStore.emitChange(\"adding\");\n      break;\n\n    case \"CHANGE_ACTIVE\":\n      NavStore.changeActive(action.id, action.nav_id);\n      NavStore.emitChange(\"change\");\n      break;\n\n    case \"UPDATE_NAV\":\n      NavStore.setNavItems(action.id, action.nav);\n      NavStore.emitChange(\"update\");\n      break;\n    }\n};\n\nNavStore.dispatchToken = NavDispatcher.register(registeredCallback);\nNavStore.setMaxListeners(0);\n\nmodule.exports = NavStore;"]}