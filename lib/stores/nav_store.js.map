{"version":3,"sources":["../../src/stores/nav_store.js"],"names":[],"mappings":"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","file":"nav_store.js","sourcesContent":["const EventEmitter  = require(\"events\").EventEmitter\n    , assign        = require(\"react/lib/Object.assign\");\n\nconst _ = require(\"lodash\");\n\nconst NavDispatcher = require(\"../dispatchers/nav_dispatcher\");\n\n\nlet nav_items = [];\n\nconst store = {\n  emitChange(event) {\n    this.emit(event);\n  },\n\n  addChangeListener(event, callback) {\n    this.on(event, callback);\n  },\n\n  removeChangeListener(event, callback) {\n    this.removeListener(event, callback);\n  },\n\n  addNavItems(items, id){\n    id = (id) ? id : _.uniqueId(\"nav\");\n    nav_items.push({items:this.setItems(items), id:id});\n  },\n\n  changeActive(id, nav_id){\n    let items = this.getNavItems(nav_id);\n    items = _.map(items, (item)=>{\n      item.active = (item.id === id);\n      return item;\n    });\n  },\n\n  getNavItems(id){\n    if(id){\n      let ni = _.find(nav_items, (ni)=>ni.id === id)\n      if(ni) return ni.items\n    }\n\n    return _.first(nav_items).items\n  },\n\n  setNavItems(id, items){\n    nav_items = _.map(nav_items, (ni)=>{\n      if(ni.id === id){\n        ni.items = items;\n      }\n      return ni;\n    })\n  },\n\n  setItems(items){\n    return _.map(items, (item)=>{\n      if(!_.has(item, \"active\")) item.active = false;\n      if(!_.has(item, \"id\")) item.id = _.uniqueId();\n      return item;\n    })\n  }\n}\n\n\nconst NavStore = assign({}, EventEmitter.prototype, store);\n\nconst registeredCallback = function(payload) {\n  let action = payload.action;\n  switch(action.type) {\n    case \"ADDING_NAV\":\n      NavStore.addNavItems(action.nav, action.id);\n      NavStore.emitChange(\"adding\");\n      break;\n\n    case \"CHANGE_ACTIVE\":\n      NavStore.changeActive(action.id, action.nav_id);\n      NavStore.emitChange(\"change\");\n      break;\n    }\n};\n\nNavStore.dispatchToken = NavDispatcher.register(registeredCallback);\nNavStore.setMaxListeners(0);\n\nmodule.exports = NavStore;"]}