(function(global,factory){if('function'==typeof define&&define.amd)define(['exports','events','lodash/core','../dispatchers/nav_dispatcher'],factory);else if('undefined'!=typeof exports)factory(exports,require('events'),require('lodash/core'),require('../dispatchers/nav_dispatcher'));else{var mod={exports:{}};factory(mod.exports,global.events,global.core,global.nav_dispatcher),global.nav_store=mod.exports}})(this,function(exports,_events,_core,_nav_dispatcher){'use strict';function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,'__esModule',{value:!0});var _core2=_interopRequireDefault(_core),_nav_dispatcher2=_interopRequireDefault(_nav_dispatcher),nav_items=[],NavStore=Object.assign({},_events.EventEmitter.prototype,{emitChange:function(event){this.emit(event)},addChangeListener:function(event,callback){this.on(event,callback)},removeChangeListener:function(event,callback){this.removeListener(event,callback)},addNavItems:function(items,id){id=id?id:_core2.default.uniqueId('nav'),nav_items.push({items:this.setItems(items),id:id})},changeActive:function(id,nav_id){var items=this.getNavItems(nav_id);items=_core2.default.map(items,function(item){return item.active=item.id===id,item})},getNavItems:function(id){if(id){var ni=_core2.default.find(nav_items,function(ni){return ni.id===id});if(ni)return ni.items}return _core2.default.first(nav_items).items},setNavItems:function(id,items){nav_items=_core2.default.map(nav_items,function(ni){return ni.id===id&&(ni.items=items),ni})},setItems:function(items){return _core2.default.map(items,function(item){return _core2.default.has(item,'active')||(item.active=!1),_core2.default.has(item,'id')||(item.id=_core2.default.uniqueId()),item})}});NavStore.dispatchToken=_nav_dispatcher2.default.register(function registeredCallback(payload){var action=payload.action;switch(action.type){case'ADDING_NAV':NavStore.addNavItems(action.nav,action.id),NavStore.emitChange('adding');break;case'CHANGE_ACTIVE':NavStore.changeActive(action.id,action.nav_id),NavStore.emitChange('change');break;case'UPDATE_NAV':NavStore.setNavItems(action.id,action.nav),NavStore.emitChange('update');}}),NavStore.setMaxListeners(0),exports.default=NavStore});